#+TITLE: RIV algorithm mini-app

A mini-app to isolate the RIV algorithm and facilitate the comparison with the HIP implementation.

Fortran pseudocode:

#+begin_src f90
  ovlpefn(nb*nb, n_aux) = 0.0d0
  do k = 1, n_points
     psi_x_psi(nb * nb) = dger(psi(1:nb, k), psi(1:nb, k)) ! Flattened outer product (possibly using lapack)
     psi_x_psi_x_aux(nb*nb, n_aux) = dger(psi_x_psi(1:nb*nb), aux(1:n_aux))
     do p = 1, n_aux
        do mn = 1, nb*nb
           ovlpefn(mn, p) = ovlpefn(mn, p) + psi_x_psi_x_aux(mn, p) * part_atoms(mn, p, k) ! Hadamard
        end do
     end do
  end do
#+end_src

